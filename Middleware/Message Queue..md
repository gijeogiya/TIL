# 메세지 큐(Message Queue)
![image](https://github.com/user-attachments/assets/62ad3d48-a9cc-4f3a-80e3-2d89476e4a17)
- 백엔드 개발자로써 개발을 하다보면 메세지 큐(Message Queue) 을 많이 접하게 된다.
- 특히 MSA 아키텍처로 많은 개발이 이루어지고 있는 현재 핵심 역할을 하는 메세지 큐 에 대해서 선제적인 이해가 꼭 필요하다.
## 메세지 지향 미들웨어(MOM)
> 메세지 지향 미들웨어란 응용 소프트웨어 간의 비동기적 데이터 통신을 위한 소프트웨어이다.
- 비동기적(Asynchronous) 한 방식을 이용해서 프로세스간의 데이터를 주고 받는 기능을 위한 시스템이다.
- 메세지 지향 미들웨어는 메세지를 전달하는 과정에서 보관하거나 라우팅 및 변환할 수 있다는 장점을 가진다.
- 메세지의 백업 기능을 유지함으로 써 지속성을 제공하며 이 덕분에 송수신 측은 동시에 네트워크 연결을 유지할 필요가 없다.(보관)
- 미들웨어 계층 자신이 직접 메세지 라우팅을 수행하기 때문에, 하나의 메세지를 여러 수신자에게 배포가 가능하다.(라우팅)
- 송수신 측의 요구에 따라 전달하는 메세지를 변환할 수 있다.(변환)
- 이에 핵심적으로 알아볼 메세지 큐 는 메세지 지향 미들웨어에 속한다.
## 메세지 큐
- Queue 란 선입선출(First in First out) 구조를 가진 자료구조이다.
- Queue 는 2개의 끝을 가지며 각각은 입구와 출구이다.
- 새로운 데이터는 입구로 들어오고 나가는 데이터는 출구에서 나간다.
- 메세지 큐(Message Queue) 란 Queue 라는 자료구조를 채택해서 메세지를 전달하는 시스템이며, 메세지 지향 미들웨어(MOM) 을 구현한 시스템이다.
- 메세지 큐를 통해 메세지를 전달하려면 메세지를 전달하는 부분과 메세지를 받는 부분이 필요하다.
- 여기서 메세지를 발행하고 전달하는 부분을 Producer 라고 하며, 메세지를 받아서 소비하는 부분을 Consumer 라고 한다.
- 메세지 큐는 Producer 와 Consumer 의 메세지 전달 역할을 하는 매개체이다.
- 메세지 큐는 요즘 가장 핫한 소프트웨어 아키텍처 디자인 패턴인 MSA(Microservice Architecture) 에서 아키텍처의 핵심적인 역할을 한다.
## 메세지 브로커 VS 이벤트 브로커
- 메세지 큐에서 데이터를 운반하는 방식에 따라 메세지 브로커 와 이벤트 브로커 로 나눌 수 있다.
- 메세지 큐와 두 브로커는 다른 개념이다.
- 메세지 큐가 메세지 혹은 이벤트가 송신되고 수신되는 하나의 통신 통로라고 하면
- 브로커는 메세지 큐에 메세지 혹은 이벤트를 넣어주고 중개하는 역할을 하는 주체이다.
- 하지만, 메세지 큐 자체를 메세지 브로커 혹은 이벤트 브로커로 이해하면 좋을 것 같다.
### 메세지 브로커(Message Broker)
- 메세지 브로커는 Producer 가 생산한 메세지를 메세지 큐에 저장하고, 저장된 메세지를 Consumer가 가져갈 수 있도록 한다.
- 메세지 브로커는 Consumer 가 메세지 큐에서 데이터를 가져가게 되면 짧은 시간 내에 메세지 큐에서 삭제되는 특징이 있다.
- ex) RabbitMQ, ActiveMQ, AWS SQS, Redis
### 이벤트 브로커(Event Broker)
- 이벤트 브로커 또한 기본적으로 메세지 브로커의 역할을 할 수 있다.
- 하지만 반대로 메세지 브로커는 이벤트 브로커의 기능을 하지 못한다.
- 이벤트 브로커가 관리하는 데이터를 이벤트라고 하며 Consumer 가 메세지 큐에서 데이터를 가져가게 되면 짧은 시간 내에 메세지가 삭제되는 것과 달리, 이벤트 브로커 방식에서는 Consumer 가 소비한 데이터를 필요한 경우 다시 소비할 수 있다.
- 또한 메세지 브로커 보다 대용향 데이터를 처리할 수 있는 능력이 있다.
- ex) Kafka
